# ğŸ› ï¸ æ’ä»¶ä¸æŠ€èƒ½ç³»ç»Ÿ (Plugin & Skill System)

æ¬¢è¿æ¥åˆ°â€œæ–¹èˆŸä¹‹å¿ƒâ€çš„åˆ›æ„å·¥åŠï¼æœ¬ç›®å½•æ˜¯å® ç‰©æ‰€æœ‰â€œ**ä¸»åŠ¨æŠ€èƒ½**â€ï¼ˆå³å·¥å…·è°ƒç”¨èƒ½åŠ›ï¼‰çš„å®¶å›­ã€‚é€šè¿‡åˆ›å»ºæ’ä»¶ï¼Œä½ å¯ä»¥æ•™ä¼šä½ çš„å® ç‰©æ–°çš„é­”æ³•ï¼Œè®©å®ƒä¸ºä½ æ‰“å¼€åº”ç”¨ã€æŸ¥è¯¢ä¿¡æ¯ï¼Œç”šè‡³ä¸å¤–éƒ¨ä¸–ç•Œè¿›è¡Œå…¨æ–°çš„äº’åŠ¨ã€‚

## âœ¨ è®¾è®¡å“²å­¦ (Design Philosophy)

- **ğŸ”Œ å¯æ’æ‹” (Pluggable):** æ¯ä¸ªæŠ€èƒ½éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ã€å¯è¢«åŠ¨æ€åŠ è½½çš„æ¨¡å—ï¼Œæ·»åŠ æˆ–ç§»é™¤ä¸€ä¸ªæŠ€èƒ½ï¼Œä¸åº”å½±å“æ ¸å¿ƒç¨‹åºçš„ç¨³å®šã€‚
- **ğŸ” å®‰å…¨ç¬¬ä¸€ (Safety-First):** æ‰€æœ‰æ’ä»¶éƒ½åœ¨ä¸€ä¸ªå—é™çš„â€œ**æ²™ç®±**â€å†…æ‰§è¡Œã€‚å®ƒä»¬èƒ½åšä»€ä¹ˆï¼Œå®Œå…¨ç”±å…¶åœ¨`plugin.json`ä¸­æ˜ç¡®å£°æ˜çš„â€œ**æƒé™æ¸…å•**â€æ¥å†³å®šã€‚æœªç»ç”¨æˆ·æ˜ç¡®æˆæƒï¼Œæ’ä»¶æ— æ³•è®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå±é™©æ“ä½œã€‚
- **ğŸ“œ å¥‘çº¦é©±åŠ¨ (Contract-Driven):** æ¯ä¸ªæ’ä»¶éƒ½å¿…é¡»éµå¾ªä¸€å¥—ç®€å•çš„è§„åˆ™å’Œæ¥å£ï¼Œä»¥ç¡®ä¿å®ƒä»¬èƒ½è¢«â€œå¤§è„‘â€æ­£ç¡®åœ°ç†è§£å’Œè°ƒç”¨ã€‚

---

## ğŸš€ å¿«é€Ÿå…¥é—¨ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæŠ€èƒ½

è®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„â€œè·å–ä»Šæ—¥å¤©æ°”â€æŠ€èƒ½ã€‚

### ç›®å½•ç»“æ„

é¦–å…ˆï¼Œåœ¨`plugins/skills/`ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚`my_weather_skill`ã€‚ä¸€ä¸ªæœ€åŸºç¡€çš„æ’ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š
plugins/
â””â”€â”€ skills/
â””â”€â”€ my_weather_skill/
â”œâ”€â”€ init.py # (å¯ä»¥ä¸ºç©º)
â”œâ”€â”€ skill_code.py # æŠ€èƒ½çš„é€»è¾‘ä»£ç 
â””â”€â”€ plugin.json # æ’ä»¶çš„â€œèº«ä»½è¯â€

### æ­¥éª¤ 1: ç¼–å†™æŠ€èƒ½é€»è¾‘ (`skill_code.py`)

ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª
`BaseSkill`
çš„ç±»ï¼Œå¹¶å®ç°æ ¸å¿ƒçš„
`execute`
æ–¹æ³•ã€‚

```python
# in plugins/skills/my_weather_skill/skill_code.py

import requests
from ..base import BaseSkill, SkillResult


class WeatherSkill(BaseSkill):
    # executeæ–¹æ³•æ˜¯å¿…é¡»çš„ï¼Œå®ƒæ˜¯æŠ€èƒ½çš„å…¥å£
    # args å‚æ•°æ˜¯ç”±LLMæ ¹æ®ç”¨æˆ·é—®é¢˜è§£æå‡ºçš„ç»“æ„åŒ–æ•°æ®
    async def execute(self, args: dict) -> SkillResult:
        city = args.get("city", "åŒ—äº¬")  # æä¾›ä¸€ä¸ªé»˜è®¤å€¼

        # ç”±äºæˆ‘ä»¬åœ¨plugin.jsonä¸­è¯·æ±‚äº†ç½‘ç»œæƒé™ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å®‰å…¨åœ°è¿›è¡ŒAPIè°ƒç”¨
        try:
            # æ³¨æ„ï¼šçœŸå®çš„URLåº”è¯¥ä»é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­è·å–
            response = requests.get(f"https://api.weather.com/v1/today?city={city}")
            response.raise_for_status()  # å¦‚æœè¯·æ±‚å¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸

            weather_data = response.json()
            report = f"{city}ä»Šå¤©çš„å¤©æ°”æ˜¯ï¼š{weather_data['condition']}ï¼Œæ¸©åº¦ {weather_data['temperature']}æ‘„æ°åº¦ã€‚"

            # è¿”å›ä¸€ä¸ªæˆåŠŸçš„SkillResultå¯¹è±¡ï¼Œå…¶ä¸­dataå¯ä»¥è¢«LLMç”¨äºç”Ÿæˆæœ€ç»ˆçš„è‡ªç„¶è¯­è¨€å›ç­”
            return SkillResult(success=True, data={"report": report})

        except requests.RequestException as e:
            # å¦‚æœå‘ç”Ÿä»»ä½•ç½‘ç»œé”™è¯¯ï¼Œè¿”å›ä¸€ä¸ªå¤±è´¥çš„SkillResultï¼Œå¹¶é™„ä¸Šå¯¹AIå‹å¥½çš„é”™è¯¯ä¿¡æ¯
            return SkillResult(success=False, error_message=f"ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œæˆ‘æ— æ³•è¿æ¥åˆ°å¤©æ°”æœåŠ¡ã€‚é”™è¯¯: {e}")
æ­¥éª¤ 2: åˆ›å»ºæ’ä»¶æè¿°æ–‡ä»¶ (plugin.json)
è¿™ä¸ªæ–‡ä»¶æ˜¯æ’ä»¶çš„â€œèº«ä»½è¯â€ï¼Œå®ƒå‘Šè¯‰â€œå¤§è„‘â€å…³äºä½ æŠ€èƒ½çš„ä¸€åˆ‡ã€‚
code
JSON
{
  "name": "Realtime Weather Reporter",
  "version": "1.0.0",
  "author": "YourName",
  "description": "ä¸€ä¸ªç®€å•çš„æŠ€èƒ½ï¼Œç”¨äºæŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”ã€‚",
  "entry_point": "skill_code:WeatherSkill",
  "triggers": [
    "æŸ¥è¯¢å¤©æ°”",
    "ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·",
    "çœ‹çœ‹å¤–é¢å¤©æ°”"
  ],
  "arguments": {
    "city": {
      "type": "string",
      "description": "éœ€è¦æŸ¥è¯¢çš„åŸå¸‚åç§°",
      "required": false
    }
  },
  "permissions": [
    "network_access_external"
  ]
}
å®Œæˆäº†ï¼ å°†ä½ çš„my_weather_skillæ–‡ä»¶å¤¹æ”¾å…¥plugins/skillsç›®å½•ï¼Œç„¶åé‡å¯â€œå¤§è„‘â€ã€‚PluginLoaderä¼šè‡ªåŠ¨å‘ç°ã€éªŒè¯å¹¶åŠ è½½ä½ çš„æ–°æŠ€èƒ½ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥å¯¹å® ç‰©è¯´ï¼šâ€œå¸®æˆ‘æŸ¥ä¸€ä¸‹ä¸Šæµ·çš„å¤©æ°”â€ï¼ŒDecisionMakerå°±ä¼šæ ¹æ®triggersåŒ¹é…åˆ°ä½ çš„æŠ€èƒ½ï¼Œå¹¶è°ƒç”¨å®ƒã€‚
ğŸ“š plugin.json è¯¦è§£
å­—æ®µ	ç±»å‹	å¿…é¡»?	æè¿°
name	string	æ˜¯	æ’ä»¶çš„åç§°ï¼Œç”¨äºåœ¨UIä¸­å±•ç¤ºã€‚
version	string	æ˜¯	æ’ä»¶çš„ç‰ˆæœ¬å·ï¼Œéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ã€‚
author	string	å¦	æ’ä»¶çš„ä½œè€…ã€‚
description	string	æ˜¯	å¯¹æ’ä»¶åŠŸèƒ½çš„ç®€çŸ­æè¿°ã€‚
entry_point	string	æ˜¯	æŠ€èƒ½çš„å…¥å£ç‚¹ï¼Œæ ¼å¼ä¸ºæ–‡ä»¶å:ç±»åã€‚
triggers	array[string]	æ˜¯	[æ ¸å¿ƒ] ä¸€ç³»åˆ—è‡ªç„¶è¯­è¨€çŸ­è¯­ã€‚DecisionMakerä¼šä½¿ç”¨è¿™äº›çŸ­è¯­ä½œä¸ºâ€œçº¿ç´¢â€ï¼Œé€šè¿‡è¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…ï¼Œæ¥å†³å®šä½•æ—¶åº”è¯¥è°ƒç”¨ä½ çš„æŠ€èƒ½ã€‚
arguments	object	å¦	[æ¨è] å®šä¹‰äº†ä½ çš„æŠ€èƒ½executeæ–¹æ³•æœŸæœ›æ¥æ”¶çš„å‚æ•°ã€‚è¿™ä¼šå¸®åŠ©LLMæ›´å¥½åœ°ã€æ›´ç»“æ„åŒ–åœ°è°ƒç”¨ä½ çš„æŠ€èƒ½ã€‚
permissions	array[string]	å¦	[æå…¶é‡è¦] ä½ çš„æ’ä»¶éœ€è¦å‘ç³»ç»Ÿç”³è¯·çš„æƒé™åˆ—è¡¨ã€‚å¦‚æœç•™ç©ºï¼Œä½ çš„æ’ä»¶å°†åœ¨ä¸€ä¸ªæœ€ä¸¥æ ¼çš„æ²™ç®±ä¸­è¿è¡Œï¼Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶æˆ–ç½‘ç»œè®¿é—®æƒé™ã€‚
ğŸ” æƒé™æ¸…å• (Permissions Manifest)
å®‰å…¨æ˜¯æˆ‘ä»¬æœ€ä¼˜å…ˆçš„è€ƒé‡ã€‚ä½ çš„æ’ä»¶å¿…é¡»åœ¨plugin.jsonä¸­æ˜ç¡®å£°æ˜å®ƒéœ€è¦çš„æ‰€æœ‰æƒé™ã€‚ç”¨æˆ·åœ¨å®‰è£…æ—¶ä¼šçœ‹åˆ°è¿™ä»½æ¸…å•ï¼Œå¹¶éœ€è¦æ˜ç¡®åŒæ„ã€‚
æƒé™ID	æè¿°
network_access_external	å…è®¸è®¿é—®å¤–éƒ¨äº’è”ç½‘ï¼ˆå¦‚è°ƒç”¨å¤©æ°”APIï¼‰ã€‚
filesystem_read_sandboxed	å…è®¸è¯»å–ç”¨æˆ·åœ¨UIä¸­ä¸ºæœ¬æ’ä»¶æ˜ç¡®æˆæƒçš„ã€å”¯ä¸€çš„ã€éš”ç¦»çš„æ–‡ä»¶å¤¹ã€‚
filesystem_write_sandboxed	å…è®¸å†™å…¥ç”¨æˆ·æ˜ç¡®æˆæƒçš„æ²™ç®±æ–‡ä»¶å¤¹ã€‚
clipboard_read	å…è®¸åœ¨ç‰¹å®šäº‹ä»¶è§¦å‘æ—¶ï¼ˆéåå°é™é»˜ï¼‰ï¼Œè¯»å–ç”¨æˆ·çš„å‰ªè´´æ¿å†…å®¹ã€‚
execute_command	[é«˜é£é™©] å…è®¸æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆéœ€é€šè¿‡æˆ‘ä»¬æä¾›çš„å®‰å…¨åŒ…è£…å™¨ï¼Œä¸”ç”¨æˆ·ä¼šçœ‹åˆ°é¢å¤–çš„å®‰å…¨è­¦å‘Šï¼‰ã€‚
ä»»ä½•æ’ä»¶è¯•å›¾æ‰§è¡Œå…¶æ¸…å•ä¸­æœªå£°æ˜çš„æƒé™æ“ä½œï¼Œéƒ½å°†è¢«å®‰å…¨æ²™ç®±ç«‹å³é˜»æ­¢ï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸ã€‚